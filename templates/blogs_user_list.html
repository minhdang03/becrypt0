{% extends "layout.html" %}

{% block title %}Danh sách Blog{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">

    <div class="mb-6">
        <div class="flex flex-wrap">
            <a href="{{ url_for('blogs_user.blog_list') }}" class="bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded mr-2 mb-2 hover:bg-gray-300 transition-colors">
                Tất cả
            </a>
            {% for category in categories %}
            <a href="{{ url_for('blogs_user.blog_list', category=category.id) }}" class="bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded mr-2 mb-2 hover:bg-gray-300 transition-colors">
                {{ category.name }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Nút Đăng bài viết mới -->
    {% if current_user.is_authenticated %}
    <div class="mb-6">
        <a href="{{ url_for('blogs_user.blog_create') }}" class="bg-green-500 text-white font-bold py-2 px-4 rounded hover:bg-green-600 transition-colors">
            Đăng bài viết mới
        </a>
    </div>
    {% endif %}

    <div class="space-y-8">
        {% for blog in blogs %}
        <div class="bg-white p-6 rounded-lg shadow-md flex flex-col md:flex-row">
            {% if blog.first_image_url %}
            <div class="md:w-1/3 mb-4 md:mb-0 md:mr-6">
                <a href="{{ url_for('blogs_user.blog_details', blog_id=blog.blog_id) }}">
                    <img src="{{ blog.first_image_url }}" alt="{{ blog.title }}" class="w-full h-auto rounded-lg">
                </a>
            </div>
            {% endif %}
            <div class="md:w-2/3">
                <a href="{{ url_for('blogs_user.blog_details', blog_id=blog.blog_id) }}"><h2 class="text-2xl font-semibold mb-2">{{ blog.title }}</h2></a>
                <p class="text-gray-600 mb-4">{{ blog.excerpt }}</p>
                <p class="text-gray-500 text-sm mb-4">Tác giả: <b>{{ blog.author }}</b></p>
                <p class="text-gray-500 text-sm mb-4">Ngày tạo: {{ blog.created_at.strftime('%Y-%m-%d') }}</p>
                <a href="{{ url_for('blogs_user.blog_details', blog_id=blog.blog_id) }}" class="block w-full bg-blue-500 text-white text-center py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    Đọc thêm
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="mt-8">
        <nav class="flex justify-between">
            {% if pagination.has_prev %}
            <a href="{{ url_for('blogs_user.blog_list', page=pagination.prev_num) }}" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l">
                Trước
            </a>
            {% else %}
            <span class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-l opacity-50 cursor-not-allowed">
                Trước
            </span>
            {% endif %}
            {% if pagination.has_next %}
            <a href="{{ url_for('blogs_user.blog_list', page=pagination.next_num) }}" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-r">
                Sau
            </a>
            {% else %}
            <span class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-r opacity-50 cursor-not-allowed">
                Sau
            </span>
            {% endif %}
        </nav>
    </div>
</div>
{% endblock %}